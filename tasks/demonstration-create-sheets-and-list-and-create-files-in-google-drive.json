{
  "docs": "# Demonstration: Create Google sheets, and list and create files in Google Drive\n\nThis task posts a demonstration message in the Slack channel of your choice. Try it out to learn how the Google action works!\n\n## Quick Start\n\n1. Connect your Google account in Mechanic (Settings â†’ Authentication)\n2. Set two task options:\n    - Your Google account\n    - Your choice of one or more of the  Google action demos:\n      - Create a new Google Sheet\n      - List Google Drive files\n      - Create Google Drive file\n3. Run the task\n\nLook in your Google Drive for the example files if you ran one of the create demos. Otherwise, the list of Drive files will be output in the task run event log.\n\n## Want to Learn More?\n\nThis task demonstrates how to:\n- Create a new Google Sheet in your Google Drive\n    - With a dynamic file name\n    - Setting a sheet tab title\n    - Using a couple of common Sheet cell data types: string, boolean\n- Listing a few fields from the first 10 files found in the connected Google Drive folder\n    - Alternate version which filters the search by files having \"Mechanic\" in the title\n- Creating a simple text file in the root Drive folder\n\nTake a look at the task code to see exactly how it works, then use these examples in your own tasks.\n\nThe Google Drive API documentation is primarily geared towards developers familiar with the Google API ecosystem. If the references below seem daunting, then consider trying out the [Google Drive or Google Sheet actions](https://learn.mechanic.dev/platform/integrations/google-drive-and-google-sheets) in Mechanic instead. (Note: there are demonstration tasks in the Mechanic library for each of those actions as well.)\n\n- https://developers.google.com/workspace/sheets/api/reference/rest/v4/spreadsheets\n- https://developers.google.com/workspace/drive/api/reference/rest/v3\n- https://developers.google.com/workspace/drive/api/reference/rest/v3/files",
  "halt_action_run_sequence_on_error": false,
  "name": "Demonstration: Create sheets and list and create files in Google Drive",
  "online_store_javascript": null,
  "options": {
    "google_account__required": null,
    "create_google_sheet_demo__boolean": false,
    "create_google_drive_file_demo__boolean": false,
    "list_google_drive_files_demo__boolean": false
  },
  "perform_action_runs_in_sequence": false,
  "preview_event_definitions": [],
  "script": "{% assign google_account = options.google_account__required %}\n{% assign create_google_sheet_demo = options.create_google_sheet_demo__boolean %}\n{% assign list_google_drive_files_demo = options.list_google_drive_files_demo__boolean %}\n{% assign create_google_drive_file_demo = options.create_google_drive_file_demo__boolean %}\n\n{% unless create_google_sheet_demo or list_google_drive_files_demo or create_google_drive_file_demo %}\n  {% error \"Choose at least one demo type before running this task\" %}\n{% endunless %}\n\n{% if event.topic == \"mechanic/user/trigger\" %}\n  {% if create_google_sheet_demo %}\n    {% comment %}\n      ** Google Sheets API - Create spreadsheet **\n      -- This action will create a new spreadsheet in the root Drive folder of the connected Google account, with 3 rows of data\n\n      NOTES:\n      -- The data added at sheet creation is fairly basic, see the Google Sheets API reference linked below for more complex data composition\n\n      API REFERENCE: https://developers.google.com/workspace/sheets/api/reference/rest/v4/spreadsheets\n    {% endcomment %}\n\n    {% log message: \"Calling Google Sheets API to create a spreadsheet with 3 rows.\" %}\n\n    {% action \"google\" %}\n      {\n        \"account\": {{ google_account | json }},\n        \"method\": \"POST\",\n        \"url_path\": \"/sheets/v4/spreadsheets\",\n        \"headers\": {\n          \"Accept\": \"application/json\",\n          \"Content-Type\": \"application/json\"\n        },\n        \"body\": {\n          \"properties\": {\n            \"title\": \"Mechanic Demo Sheet {{ \"now\" | date: \"%Y-%m-%d %H:%M:%S\" }}\"\n          },\n          \"sheets\": [\n            {\n              \"properties\": {\n                \"title\": \"Demo orders\"\n              },\n              \"data\": [\n                {\n                  \"rowData\": [\n                    {\n                      \"values\": [\n                        {\n                          \"userEnteredValue\": {\n                            \"stringValue\": \"Order name\"\n                          }\n                        },\n                        {\n                          \"userEnteredValue\": {\n                            \"stringValue\": \"Date\"\n                          }\n                        },\n                        {\n                          \"userEnteredValue\": {\n                            \"stringValue\": \"Shipped\"\n                          }\n                        }\n                      ]\n                    },\n                    {\n                      \"values\": [\n                        {\n                          \"userEnteredValue\": {\n                            \"stringValue\": \"#1234\"\n                          }\n                        },\n                        {\n                          \"userEnteredValue\": {\n                            \"stringValue\": \"2025-10-01T12:00:00Z\"\n                          }\n                        },\n                        {\n                          \"userEnteredValue\": {\n                            \"boolValue\": true\n                          }\n                        }\n                      ]\n                    },\n                    {\n                      \"values\": [\n                        {\n                          \"userEnteredValue\": {\n                            \"stringValue\": \"#1357\"\n                          }\n                        },\n                        {\n                          \"userEnteredValue\": {\n                            \"stringValue\": \"2025-10-05T12:00:00Z\"\n                          }\n                        },\n                        {\n                          \"userEnteredValue\": {\n                            \"boolValue\": false\n                          }\n                        }\n                      ]\n                    }\n                  ]\n                }\n              ]\n            }\n          ]\n        }\n      }\n    {% endaction %}\n  {% endif %}\n\n  {% if list_google_drive_files_demo %}\n    {% comment %}\n      ** Google Drive API - List files **\n      -- This action will list the first 10 files from the Drive of the connected Google account\n\n      NOTES:\n      -- The listed files must have been created previously by this Mechanic integration\n      -- This action uses a GET request with a body object to pass querystring parameters, which is a different behavior than using a GET in an \"http\" action\n      -- The \"fields\" parameter limits the amount of data return to the listed fields\n\n      API REFERENCE: https://developers.google.com/workspace/drive/api/reference/rest/v3\n    {% endcomment %}\n\n    {% log message: \"Calling Google Drive API to get a list of files.\" %}\n\n    {% action \"google\" %}\n      {\n        \"account\": {{ google_account | json }},\n        \"method\": \"GET\",\n        \"url_path\": \"/drive/v3/files\",\n        \"headers\": {\n          \"Accept\": \"application/json\"\n        },\n        \"body\": {\n          \"pageSize\": 10,\n          \"fields\": \"files(id,name,mimeType,createdTime)\",\n          \"trashed\": false\n        }\n      }\n    {% endaction %}\n\n    {% comment %}\n      ** Google Drive API - List files with 'Mechanic' in the name **\n      -- This action will list the first 10 files from the Drive of the connected Google account where the name contains 'Mechanic'\n\n      NOTES:\n      -- The listed files must have been created previously by this Mechanic integration\n      -- This action uses a GET request with a body object to pass querystring parameters, which is a different behavior than using a GET in an \"http\" action\n      -- The \"q\" parameter is a Google Drive API specific feature for filtering (https://developers.google.com/workspace/drive/api/guides/search-files#examples)\n      -- The \"fields\" parameter limits the amount of data return to the listed fields\n      -- This action likely will not return any files until one of the create demo actions has been separately run\n\n      API REFERENCE: https://developers.google.com/workspace/drive/api/reference/rest/v3\n    {% endcomment %}\n\n    {% log message: \"Calling Google Drive API to get a list of files where the name contains 'Mechanic'.\" %}\n\n    {% action \"google\" %}\n      {\n        \"account\": {{ google_account | json }},\n        \"method\": \"GET\",\n        \"url_path\": \"/drive/v3/files\",\n        \"headers\": {\n          \"Accept\": \"application/json\"\n        },\n        \"body\": {\n          \"q\": \"name contains 'Mechanic'\",\n          \"pageSize\": 10,\n          \"fields\": \"files(id,name,mimeType,createdTime)\",\n          \"trashed\": false\n        }\n      }\n    {% endaction %}\n  {% endif %}\n\n  {% if create_google_drive_file_demo %}\n    {% comment %}\n      ** Google Drive API - Create file **\n      -- This action will create a new text file in the root Drive folder of the connected Google account\n\n      NOTES:\n      -- To handle more complex file types, see the Google Files API reference linked below\n\n      API REFERENCE: https://developers.google.com/workspace/drive/api/reference/rest/v3/files\n    {% endcomment %}\n\n    {% log message: \"Calling Google Drive API to create a new text file.\" %}\n\n    {% action \"google\" %}\n      {\n        \"account\": {{ google_account | json }},\n        \"method\": \"POST\",\n        \"url_path\": \"/upload/drive/v3/files?uploadType=media\",\n        \"headers\": {\n          \"Content-Type\": \"text/plain\"\n        },\n        \"body\": \"This is a test file created by Mechanic at {{ \"now\" | date: \"%Y-%m-%d %H:%M:%S\" }}\"\n      }\n    {% endaction %}\n  {% endif %}\n\n{% elsif event.topic == \"mechanic/actions/perform\" %}\n  {% if event.preview %}\n    {% capture action_json %}\n      {\n        \"type\": \"google\",\n        \"run\": {\n          \"ok\": true,\n          \"result\": {\n            \"status\": 200\n          }\n        }\n      }\n    {% endcapture %}\n\n    {% assign action = action_json | parse_json %}\n  {% endif %}\n\n  {% unless action.run.ok and action.type == \"google\" %}\n    {% break %}\n  {% endunless %}\n\n  {% if action.run.result.status != 200 %}\n    {% unless event.preview %}\n      {% error \"Google API call returned a non-200 response. Review the event log to see what information the API response provided.\" %}\n    {% endunless %}\n  {% endif %}\n\n  {% comment %}\n    -- NOTE: Typically if a task might perform multiple actions that need further processing, then the actions would pass along \"meta\" information to more easily distinguish between them. This was not done for this demo task to keep the action tags in the more common usage format.\n  {% endcomment %}\n\n  {% if action.options.method == \"GET\" and action.options.url_path == \"/drive/v3/files\" %}\n    {% log files_list: action.run.result.body.files %}\n\n  {% elsif action.options.method == \"POST\" and action.options.url_path == \"/upload/drive/v3/files?uploadType=media\" %}\n    {% log file_data: action.run.result.body %}\n\n  {% elsif action.options.method == \"POST\" and action.options.url_path == \"/sheets/v4/spreadsheets\" %}\n    {% log sheet_data: action.run.result.body %}\n  {% endif %}\n{% endif %}\n",
  "subscriptions": [
    "mechanic/user/trigger",
    "mechanic/actions/perform"
  ],
  "subscriptions_template": "mechanic/user/trigger\nmechanic/actions/perform",
  "tags": [
    "Demonstration",
    "Google Drive",
    "Google Sheets",
    "Integration"
  ]
}
